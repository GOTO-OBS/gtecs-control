#!/usr/bin/env python
"""
A script to change the system control mode
"""

import sys

from gtecs import flags
from gtecs import params
from gtecs.misc import execute_command

status = flags.Status()

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print('Usage: mode [manual|robotic]')
        print('  System is currently in {} mode.'.format(status.mode.upper()))
        print('  Current observer is "{}".'.format(status.observer))
    else:
        m_args = ['m', '-m', 'manual', '--manual']
        r_args = ['r', '-r', 'robotic', '--robotic']
        new_mode = sys.argv[1].lower()

        if new_mode not in r_args+m_args:
            print('ERROR: "{}" is an invalid mode'.format(new_mode))
            print('Usage: mode [manual|robotic]')

        elif new_mode in m_args:
            username = input('Please enter your name for the record: ')
            if len(username) == 0:
                username = 'Unknown'
            status.observer = username
            print('Thank you "{}", everything will now be blamed on you'.format(username))

            status.mode = 'manual'
            print('System now in Manual mode, you are in control')

        elif new_mode in r_args:
            # this sets the observer to "GOTO-pilot"
            # and turns on dome autoclose
            status.mode = 'robotic'
            print('System now in Robotic mode, the pilot is in control')
